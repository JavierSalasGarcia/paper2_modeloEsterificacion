# Configuración del Sistema de Modelado de Esterificación
# Archivo de configuración principal
# Copiar este archivo como 'config.yaml' en la raíz del proyecto

# ============================================================================
# CONFIGURACIÓN GENERAL
# ============================================================================
general:
  project_name: "Modelado_Biodiésel_CaO"
  output_dir: "results/"
  create_subdirs: true
  verbose: true
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  log_file: "logs/sistema.log"

# ============================================================================
# CONFIGURACIÓN DE MODELOS CINÉTICOS
# ============================================================================
kinetic_model:
  # Tipo de modelo: '1-step' o '3-step'
  model_type: "1-step"

  # Reversibilidad
  reversible: true

  # Método de integración ODE
  ode_solver:
    method: "Radau"  # Radau, BDF, LSODA
    rtol: 1.0e-6
    atol: 1.0e-9
    max_step: 0.1

  # Parámetros cinéticos iniciales (para ajuste)
  initial_guess:
    A_forward_min-1: 1.0e10
    Ea_forward_kJ_mol: 60.0
    A_reverse_min-1: 1.0e8
    Ea_reverse_kJ_mol: 50.0

  # Límites para ajuste de parámetros
  parameter_bounds:
    A_forward_min-1: [1.0e6, 1.0e12]
    Ea_forward_kJ_mol: [30.0, 100.0]
    A_reverse_min-1: [1.0e4, 1.0e10]
    Ea_reverse_kJ_mol: [20.0, 80.0]

# ============================================================================
# CONFIGURACIÓN DE PROCESAMIENTO GC-FID
# ============================================================================
gc_processing:
  # Archivo de datos crudos
  data_format: "CSV"  # CSV, Excel, JSON

  # Columnas esperadas en CSV
  csv_columns:
    time: "tiempo_min"
    compound: "compuesto"
    area: "area_pico"
    retention_time: "tiempo_retencion_min"

  # Estándar interno
  internal_standard:
    name: "Estándar_Interno"
    concentration_mg_mL: 2.0
    MW_g_mol: 226.4

  # Factores de respuesta (relativos al estándar interno)
  response_factors:
    TG: 1.00
    DG: 0.92
    MG: 0.88
    FAME: 0.95
    GL: 0.90
    MeOH: 0.85

  # Opciones de procesamiento
  options:
    interpolate_missing: true
    smooth_data: false
    smooth_window: 5
    remove_outliers: true
    outlier_std_threshold: 3.0

# ============================================================================
# CONFIGURACIÓN DE AJUSTE DE PARÁMETROS
# ============================================================================
parameter_fitting:
  # Método de optimización
  method: "leastsq"  # leastsq, least_squares, differential_evolution, nelder

  # Opciones del optimizador
  optimizer_options:
    max_nfev: 1000
    ftol: 1.0e-8
    xtol: 1.0e-8
    gtol: 1.0e-8

  # Pesos para diferentes experimentos
  experiment_weights:
    use_weights: false
    weight_by: "inverse_variance"  # uniform, inverse_variance, custom

  # Intervalos de confianza
  confidence_intervals:
    calculate: true
    confidence_level: 0.95

# ============================================================================
# CONFIGURACIÓN DE OPTIMIZACIÓN
# ============================================================================
optimization:
  # Variables a optimizar
  variables:
    temperature:
      optimize: true
      bounds: [50.0, 80.0]  # °C
      initial: 65.0
    rpm:
      optimize: true
      bounds: [200.0, 800.0]
      initial: 600.0
    catalyst_percent:
      optimize: true
      bounds: [1.0, 5.0]  # % masa
      initial: 3.0

  # Función objetivo
  objective:
    type: "maximize_conversion"  # maximize_conversion, maximize_yield, minimize_time
    target_conversion_%: 95.0
    max_reaction_time_min: 120

  # Algoritmo de optimización
  algorithm:
    method: "differential_evolution"  # differential_evolution, SLSQP, dual_annealing
    maxiter: 100
    popsize: 15
    tol: 0.01
    workers: -1  # -1 = usar todos los CPUs

  # Superficie de respuesta
  response_surface:
    generate: true
    resolution: 20  # puntos por dimensión
    var1: "temperature"
    var2: "catalyst_percent"

# ============================================================================
# CONFIGURACIÓN DE VISUALIZACIÓN
# ============================================================================
visualization:
  # Formato de gráficas
  figure_format: "png"  # png, pdf, svg
  dpi: 300
  figure_size: [10, 6]  # pulgadas [ancho, alto]

  # Estilo
  style: "seaborn-v0_8-darkgrid"  # seaborn, ggplot, bmh
  color_palette: "Set2"
  font_size: 12

  # Tipos de gráficas a generar
  plots:
    conversion_vs_time: true
    concentration_profiles: true
    parity_plots: true
    response_surface_3d: true
    sensitivity_tornado: true
    residual_analysis: true

  # Opciones específicas
  options:
    show_confidence_bands: true
    show_experimental_points: true
    show_legend: true
    grid: true

# ============================================================================
# CONFIGURACIÓN DE EXPORTACIÓN
# ============================================================================
export:
  # Formatos de exportación
  formats:
    excel: true
    json: true
    csv: true
    pdf_report: false  # Requiere LaTeX

  # Opciones de Excel
  excel_options:
    multi_sheet: true
    include_plots: true
    include_metadata: true

  # Opciones de JSON
  json_options:
    indent: 2
    ensure_ascii: false

  # Nombres de archivos
  file_naming:
    prefix: "resultado"
    include_timestamp: true
    include_experiment_id: true

# ============================================================================
# CONFIGURACIÓN DE CFD (AVANZADO)
# ============================================================================
cfd:
  enabled: false  # Cambiar a true para usar PyFluent

  fluent_config:
    working_dir: "cfd/fluent/"
    mesh_file: null  # Ruta a archivo de malla
    case_file: null

  reactor_geometry:
    diameter_mm: 270.0
    height_mm: 350.0
    volume_L: 20.0

  impeller:
    type: "Rushton"
    diameter_mm: 90.0
    rpm: 600.0

  turbulence_model: "k-epsilon-RNG"

  species_transport:
    enabled: true
    species: ["TG", "MeOH", "FAME", "GL"]

  kinetics:
    use_udf: true
    udf_file: "cfd/udf/kinetics.c"

# ============================================================================
# CONFIGURACIÓN DE PRUEBAS Y VALIDACIÓN
# ============================================================================
testing:
  run_validation: false
  validation_dataset: "data/validation/"

  metrics:
    calculate_R2: true
    calculate_RMSE: true
    calculate_MAE: true
    calculate_MAPE: true

  cross_validation:
    enabled: false
    k_folds: 5

# ============================================================================
# FIN DE CONFIGURACIÓN
# ============================================================================
